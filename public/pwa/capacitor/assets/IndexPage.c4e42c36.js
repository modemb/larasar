import{a as R,b as oe,c as G,d as O}from"./PostLocation.18462df1.js";import{W as le,P as re,Q as se}from"./UserPost.9b6312ed.js";import{u as J}from"./use-quasar.41efb91a.js";import{u as K,b as ie}from"./axios.dd0a7574.js";import{Q as E}from"./QCard.ec410a0e.js";import{Q as ne,f as ce,g as z,h as N}from"./QCheckbox.b8d0cf70.js";import{r as Q,c as n,w as D,o as de,X as T,R as c,S as C,f as a,Y as r,bc as me,a0 as y,a3 as S,Q as A,U as X,a1 as U,a4 as L,bd as ue,F as ge,u as pe}from"./index.08e86ffb.js";import{Q as ye}from"./ClosePopup.71a35b4b.js";import{Q as H}from"./QImg.786665cf.js";import{Q as fe}from"./QCardSection.3d25e11d.js";import{Q as be,b as _e}from"./QTable.7b2293dc.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import ve from"./PostsCategories.520fb32e.js";import"./QLayout.f367b0a4.js";import"./QSeparator.e65deedb.js";import"./use-dark.09fea322.js";import"./TouchPan.81640d8c.js";import"./export-file.200e4ebe.js";import"./QForm.b5701193.js";import"./Functions.a6828b9d.js";import"./GoogleAutocomplete.1506f244.js";import"./QSpace.2b47e780.js";import"./QToggle.c5ba4237.js";import"./UserFiles.b62f67b7.js";import"./QPage.04ecbe7a.js";import"./QPageContainer.58a868ff.js";import"./QEditor.2dc398a7.js";import"./QBtnDropdown.92e4f5d8.js";import"./QTooltip.6758108f.js";import"./UserCheckout.70f50a93.js";import"./UserReports.1bc0db70.js";import"./QPopupProxy.40be37ab.js";import"./QTr.5fbb2c40.js";import"./i18n.a0f971c3.js";import"./UserShare.9975d54e.js";import"./Auth.1fdd8b5e.js";import"./LocaleDropdown.7d1de440.js";const we={components:{Wish:le,Post:re},setup(){const s=J(),l=K(),{crudAction:f,notifyAction:e}=l,i=Q(null),B=Q({}),m=Q(!1),V=Q(""),d=Q(!1),o=n(()=>{var t;return(t=l.galleryGetter)==null?void 0:t.last_page}),u=n(()=>{var t;return(t=l.locationGetter)==null?void 0:t.location}),b=n(()=>{var t;return(t=l.distanceGetter)==null?void 0:t.distance}),_=n(()=>{var t;return(t=l.configGetter)==null?void 0:t.locale}),P=n(()=>{var t;return(t=l.reloadGetter)==null?void 0:t.reload}),g=n(()=>{var t;return(t=l.galleryGetter)==null?void 0:t.total}),v=n(()=>{var t;return((t=l.galleryGetter)==null?void 0:t.data)||[]}),W=n(()=>l.authGetter),$=!1,j=t=>f({p:t,mutate:"scrollGalleryGetter",refresh:["scrollGalleryGetter"]});let ee=0;function Y(){return ee}const w=Q({sortBy:"desc",descending:!1,page:1,rowsPerPage:Y(),rowsNumber:g.value});D(()=>s.screen.name,()=>w.value.rowsPerPage=Y()),D([u,b,P],()=>I({refresh:["galleryGetter"]}));const F=[];D(V,t=>{w.value.page=1,F.includes(t)||I({filterGallery:t,load:!0}),F.push(t)});function I(t){var h,k;const p=(h=l.scrollGalleryGetter)==null?void 0:h.p;return p!==null&&scrollTo(0,p),console.log(),f({...t,...b.value,url:"api/categories/gallery",method:"get",mutate:"galleryGetter",page:w.value.page,auth_id:(k=W.value)==null?void 0:k.id,locale:_.value,timeout:1e3,loc:u.value}).catch(x=>e({error:"GalleryAction",e:x}))}de(()=>{i.value.requestServerInteraction(),I({})});function te({to:t,ref:p}){var q,M;const h=((q=v.value)==null?void 0:q.length)-1,k=w.value.page,x=o.value;j(scrollY),g.value!==((M=v.value)==null?void 0:M.length)&&(m.value!==!0&&k<x&&t===h&&(document.body.style.overflow="hidden",m.value=!0,setTimeout(()=>{w.value.page++,I({load:!0}).then(()=>document.body.style.overflow="auto"),pe(()=>{p.refresh(),m.value=!1})},500)),console.log("page",k,"<","lastPage",x,"to",t,"===",h,"lastIndex","total",g.value,scrollY))}function ae(t){var q;const p=(q=v.value)==null?void 0:q.length,h=o.value,k=w.value.page,x=Math.round(t/p);j(t),m.value!==!0&&k<h&&x===p&&p<g.value&&(document.body.style.overflow="hidden",m.value=!0,setTimeout(()=>{m.value=!1,w.value.page++,I({load:!0}),document.body.style.overflow="auto"},1500)),console.log("page",k,"<","lastPage",h,"to",x,"===",p,"lastIndex","total",g.value)}return{height:n(()=>screen.height/1.4),grid:$,tableRef:i,auth:W,filter:V,baseURL:ie,price:0,pagination:w,postData:B,view:d,locale:_,loading:m,viewPost(t){B.value=t,d.value=!0},_onScroll:ae,onScroll:te,columns:[{name:"post_title",align:"center",label:"post_title",field:"post_title",sortable:!0},{name:"description",align:"center",label:"description",field:"description",sortable:!0},{name:"address",align:"center",label:"address",field:"address",sortable:!0},{name:"city",align:"center",label:"city",field:"city",sortable:!0}],rows:v,cardContainerStyle:n(()=>{var t;return{height:((t=v.value)==null?void 0:t.length)*200+"px"}}),cardContainerClass:n(()=>s.screen.gt.xs?"grid-masonry grid-masonry--"+(s.screen.gt.sm?"3":"2"):""),rowsPerPageOptions:n(()=>s.screen.gt.xs?s.screen.gt.sm?[3,6,9]:[3,6]:[3])}}},he={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ke=["onClick"],Pe={class:"col-12 *ellipsis"},xe={key:0,class:"col-6 q-mt-md"},Qe={key:1,class:"col-6"},Se={class:"col-6"},Ve={class:"q-pa-md q-gutter-md"},Ge={class:"text-weight-medium"},Ce={class:"text-grey-8"},Ie={key:0,class:"text-grey-8 q-pa-md"},qe={key:0,class:"timestamp timeago q-pa-md"},Ue={class:"text-grey-8 q-gutter-xs"};function De(s,l,f,e,i,B){const m=T("Post"),V=T("Wish"),d=T("wish");return c(),C(ge,null,[a(ne,{modelValue:e.view,"onUpdate:modelValue":l[0]||(l[0]=o=>e.view=o)},{default:r(()=>[a(E,{class:"my-card col-12",style:{width:"1250px"}},{default:r(()=>[a(m,{postData:e.postData},null,8,["postData"])]),_:1})]),_:1},8,["modelValue"]),a(_e,{flat:"",bordered:"",grid:e.grid,style:ue(`height: ${e.height}px`),"card-container-class":e.cardContainerClass,"card-container-style":e.cardContainerStyle,title:s.$t("gallery"),rows:e.rows,columns:e.columns,filter:e.filter,"row-key":"name",loading:e.loading,"hide-header":"",ref:"tableRef","binary-state-sort":"","rows-per-page-options":e.rowsPerPageOptions,pagination:e.pagination,"onUpdate:pagination":l[2]||(l[2]=o=>e.pagination=o),"virtual-scroll":"","virtual-scroll-item-size":150,"virtual-scroll-sticky-size-start":150,onVirtualScroll:e.onScroll},me({"top-right":r(()=>[a(ye,{clearable:"",borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":l[1]||(l[1]=o=>e.filter=o),placeholder:"Search"},{append:r(()=>[a(A,{name:"search"})]),_:1},8,["modelValue"])]),_:2},[e.grid?{name:"item",fn:r(o=>[y("div",he,[a(E,{class:"my-card"},{default:r(()=>{var u,b,_,P;return[y("div",{style:{cursor:"pointer"},onClick:g=>e.viewPost(o.row)},[(b=(u=o.row.pics)==null?void 0:u[0])!=null&&b.pic?(c(),S(H,{key:0,src:e.baseURL+"/"+((P=(_=o.row.pics)==null?void 0:_[0])==null?void 0:P.pic),class:"rounded-borders"},null,8,["src"])):(c(),S(A,{key:1,name:"far fa-image",color:"black",size:"150px"}))],8,ke),a(fe,{class:"row"},{default:r(()=>[y("div",Pe,[a(X,{color:"primary",to:`/post/${o.row.id}`,label:o.row.post_title},null,8,["to","label"])]),(e.price=o.row.price)>0?(c(),C("div",xe,U(Number(e.price).toLocaleString(e.locale,{style:"currency",currency:o.row.currency_code||"USD"})),1)):(c(),C("div",Qe)),y("div",Se,[a(V,{fab:"",post:o.row},null,8,["post"])])]),_:2},1024)]}),_:2},1024)])]),key:"0"}:{name:"body",fn:r(o=>[y("div",Ve,[a(be,{bordered:"",class:"rounded-borders",style:{"max-width":"1600px"}},{default:r(()=>[a(ce,null,{default:r(()=>[a(z,{style:{"max-width":"150px","max-height":"150px",cursor:"pointer"},onClick:u=>e.viewPost(o.row)},{default:r(()=>{var u,b,_,P,g,v;return[(_=(b=(u=o.row)==null?void 0:u.pics)==null?void 0:b[0])!=null&&_.pic?(c(),S(H,{key:0,src:e.baseURL+"/"+((v=(g=(P=o.row)==null?void 0:P.pics)==null?void 0:g[0])==null?void 0:v.pic)},null,8,["src"])):(c(),S(A,{key:1,name:"fas fa-plus-circle",color:"black",size:"150px"}))]}),_:2},1032,["onClick"]),a(z,null,{default:r(()=>[a(N,{lines:"1"},{default:r(()=>[y("span",Ge,U(o.row.city),1),y("span",Ce,U(o.row.postal_code),1)]),_:2},1024),a(N,{lines:"1",class:"q-mt-xs text-body2 text-weight-bold text-primary text-uppercase"},{default:r(()=>[a(X,{flat:"",label:o.row.post_title,to:"/post/"+o.row.id},null,8,["label","to"])]),_:2},1024),a(N,{caption:"",lines:"1"},{default:r(()=>[o.row.price>0?(c(),C("span",Ie,U(Number(o.row.price).toLocaleString(e.locale,{style:"currency",currency:o.row.currency_code||"USD"})),1)):L("",!0)]),_:2},1024),a(N,{caption:"",lines:"1"},{default:r(()=>[s.ipDebug?(c(),C("small",qe,U(s.timeago(o.row.start_date)),1)):L("",!0)]),_:2},1024)]),_:2},1024),a(z,{side:""},{default:r(()=>[y("div",Ue,[a(d,{post:o.row},null,8,["post"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),key:"1"}]),1032,["grid","style","card-container-class","card-container-style","title","rows","columns","filter","loading","rows-per-page-options","pagination","onVirtualScroll"])],64)}var Te=Z(we,[["render",De]]);const Le={components:{Gallery:Te,Categories:ve},setup(){const s=J(),l=K(),f=Q(s.cookies.get("tab")||"gallery"),e=n(()=>{var i;return((i=l.galleryGetter)==null?void 0:i.data)||[]});return D(f,i=>s.cookies.set("tab",i,{expires:"1h"})),D(e,i=>f.value=i!=null&&i.length?"gallery":"categories"),{tab:f,rows:e,stickyPosition:!0,desktop:s.platform.is.desktop}}},Be={class:"*q-pa-md"},Ne={class:"q-gutter-y-md"};function Re(s,l,f,e,i,B){const m=T("gallery"),V=T("categories");return c(),C("div",Be,[y("div",Ne,[e.stickyPosition?L("",!0):(c(),S(R,{key:0,modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=d=>e.tab=d),dense:"",class:"bg-grey-3","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[a(G,{name:"gallery",label:s.$t("gallery")},null,8,["label"]),a(G,{name:"categories",label:s.$t("categories")},null,8,["label"])]),_:1},8,["modelValue"])),a(oe,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=d=>e.tab=d),animated:"",swipeable:""},{default:r(()=>[a(O,{name:"gallery"},{default:r(()=>[a(m)]),_:1}),a(O,{name:"categories"},{default:r(()=>[a(V)]),_:1})]),_:1},8,["modelValue"]),e.stickyPosition?L("",!0):(c(),S(R,{key:1,modelValue:e.tab,"onUpdate:modelValue":l[2]||(l[2]=d=>e.tab=d),dense:"",class:"bg-grey-3","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[a(G,{name:"gallery",label:s.$t("gallery")},null,8,["label"]),a(G,{name:"categories",label:s.$t("categories")},null,8,["label"])]),_:1},8,["modelValue"])),a(se,{position:e.desktop?"top":"bottom-right",offset:[18,18]},{default:r(()=>[e.stickyPosition?(c(),S(R,{key:0,modelValue:e.tab,"onUpdate:modelValue":l[3]||(l[3]=d=>e.tab=d),dense:"",class:"bg-grey-3","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:r(()=>[a(G,{name:"gallery",label:s.$t("gallery")},null,8,["label"]),a(G,{name:"categories",label:s.$t("categories")},null,8,["label"])]),_:1},8,["modelValue"])):L("",!0)]),_:1},8,["position"])])])}var kt=Z(Le,[["render",Re],["__scopeId","data-v-a7512d18"]]);export{kt as default};
